<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Denise Wall Dance Energy - Competition Schedule</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet">
    <style>
        /* Global Styles */
        :root {
            --primary-color: #8e44ad;
            --secondary-color: #3498db;
            --light-color: #f5f5f5;
            --dark-color: #333;
            --success-color: #2ecc71;
            --warning-color: #e67e22;
            --highlight-color: #FFF9C4;
            --solo-color: #e3f2fd;
            --duo-trio-color: #e8f5e9;
            --group-color: #f9f0ff;
            --awards-color: #fff8e1;
            --workshop-color: #e0f7fa;
            --meeting-color: #f3e5f5;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: var(--light-color);
            color: var(--dark-color);
            line-height: 1.6;
        }
        
        h1, h2, h3, h4 {
            color: var(--primary-color);
            margin-bottom: 0.75rem;
        }
        
        /* Header Styles */
        header {
            background-color: white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            padding: 1.5rem;
            text-align: center;
        }
        
        header h1 {
            margin-bottom: 0.25rem;
            font-size: 1.8rem;
        }
        
        header h2 {
            color: var(--secondary-color);
            font-size: 1.3rem;
            margin-bottom: 0.5rem;
        }
        
        header .location-dates {
            font-size: 1rem;
            color: var(--dark-color);
            margin-top: 0.5rem;
        }
        /* Controls Styles */
        .controls {
            background-color: white;
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }
        
        .filter-controls {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            justify-content: space-between;
            align-items: center;
        }
        
        .button-controls {
            display: flex;
            justify-content: flex-end;
        }
        
        .controls select, .controls button {
            padding: 0.5rem 1rem;
            border-radius: 4px;
            border: 1px solid #ddd;
            font-size: 1rem;
        }
        
        .controls select {
            min-width: 200px;
            flex-grow: 1;
        }
        
        .controls button {
            background-color: var(--primary-color);
            color: white;
            border: none;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        
        .controls button:hover {
            background-color: #7d3c98;
        }
        
        .btn-print {
            background-color: var(--secondary-color) !important;
        }
        
        .btn-print:hover {
            background-color: #2980b9 !important;
        }
        
        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.4);
        }
        
        .modal-content {
            background-color: white;
            margin: 5% auto;
            padding: 1.5rem;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            max-width: 600px;
            width: 90%;
        }
        
        .close-modal {
            color: #aaa;
            float: right;
            font-size: 1.5rem;
            font-weight: bold;
            cursor: pointer;
        }
        
        .close-modal:hover {
            color: black;
        }
        
        /* Password Protection Styles */
        .password-input {
            width: 100%;
            padding: 10px;
            margin: 15px 0;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 16px;
        }
        
        .modal-buttons {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            margin-top: 20px;
        }
        
        .error-message {
            color: #e74c3c;
            font-weight: bold;
            margin-top: 10px;
            display: none;
        }
        
        .error-message.visible {
            display: block;
        }
        
        /* Edit Mode Styles */
        .btn-edit {
            background-color: #27ae60 !important;
        }
        
        .btn-edit:hover {
            background-color: #219653 !important;
        }
        
        .btn-save {
            background-color: #e74c3c !important;
        }
        
        .btn-save:hover {
            background-color: #c0392b !important;
        }
        
        .editable-cell {
            cursor: pointer;
            position: relative;
        }
        
        .edit-mode .editable-cell:hover {
            background-color: rgba(255, 255, 0, 0.2);
        }
        
        .edit-mode .editable-cell:hover::after {
            content: "✏️";
            position: absolute;
            right: 5px;
            top: 5px;
            font-size: 12px;
        }
        
        .time-input {
            width: 100%;
            padding: 5px;
            border: 1px solid var(--primary-color);
            border-radius: 3px;
        }
        
        .edit-controls {
            display: none;
            background-color: #f8f9fa;
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
            border: 1px solid #ddd;
        }
        
        .edit-controls.active {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            align-items: center;
        }
        
        .edit-message {
            flex-grow: 1;
            color: #27ae60;
            font-weight: bold;
        }
        
        .print-options {
            display: flex;
            flex-wrap: wrap;
            gap: 1.5rem;
            margin: 1.5rem 0;
        }
        
        .option-group {
            flex: 1;
            min-width: 200px;
        }
        
        .option-group h4 {
            margin-bottom: 0.75rem;
            font-size: 1.1rem;
        }
        
        .option-group label {
            display: block;
            margin-bottom: 0.5rem;
            cursor: pointer;
        }
        
        .print-buttons {
            display: flex;
            justify-content: flex-end;
            gap: 1rem;
            margin-top: 1.5rem;
        }
        
        .btn-secondary {
            background-color: #95a5a6 !important;
        }
        
        .btn-secondary:hover {
            background-color: #7f8c8d !important;
        }
        
        .btn-primary {
            background-color: var(--primary-color) !important;
        }
        
        .print-buttons button {
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 4px;
            color: white;
            cursor: pointer;
            font-size: 1rem;
        }
        
        /* Full Schedule View Styles */
        .full-schedule {
            margin-top: 1.5rem;
        }
        
        .date-divider {
            background-color: var(--primary-color);
            color: white;
            padding: 0.75rem 1rem;
            margin: 2rem 0 1rem 0;
            border-radius: 4px;
            font-weight: bold;
            font-size: 1.2rem;
        }
        
        .full-schedule .schedule-table th {
            position: sticky;
            top: 0;
            z-index: 10;
        }
        
        /* Tabs Styles */
        .day-tabs {
            display: flex;
            margin-bottom: 1rem;
            overflow-x: auto;
            padding-bottom: 5px;
        }
        
        .day-tab {
            padding: 0.75rem 1.5rem;
            background-color: #e0e0e0;
            color: var(--dark-color);
            border: none;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
            border-radius: 5px 5px 0 0;
            margin-right: 5px;
        }
        
        .day-tab.active {
            background-color: var(--primary-color);
            color: white;
        }
        
        /* Quick Reference Styles */
        .quick-reference {
            background-color: var(--highlight-color);
            border-left: 4px solid var(--warning-color);
            padding: 1rem;
            margin-bottom: 1.5rem;
            border-radius: 0 5px 5px 0;
        }
        
        .quick-reference h3 {
            color: var(--warning-color);
            margin-bottom: 0.5rem;
        }
        
        .quick-reference p {
            margin-bottom: 0.5rem;
            font-size: 0.95rem;
        }
        
        /* Legend Styles */
        .legend {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin: 1rem 0;
            padding: 0.5rem;
            background-color: white;
            border-radius: 4px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            font-size: 0.9rem;
        }
        
        .legend-color {
            display: inline-block;
            width: 15px;
            height: 15px;
            margin-right: 5px;
            border: 1px solid #ddd;
        }
        
        /* Schedule Table Styles */
        .schedule-container {
            overflow-x: auto;
            margin-bottom: 2rem;
        }
        
        .schedule-table {
            width: 100%;
            border-collapse: collapse;
            background-color: white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .schedule-table th, .schedule-table td {
            border: 1px solid #ddd;
            padding: 0.75rem;
            text-align: left;
        }
        
        .schedule-table th {
            background-color: var(--primary-color);
            color: white;
            position: sticky;
            top: 0;
        }
        
        .schedule-table tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        
        .schedule-table tr:hover {
            background-color: #f1f1f1;
        }
        
        /* Special row styles */
        .schedule-table tr.solo-routine {
            background-color: var(--solo-color);
        }
        
        .schedule-table tr.duo-trio-routine {
            background-color: var(--duo-trio-color);
        }
        
        .schedule-table tr.group-routine {
            background-color: var(--group-color);
        }
        
        .schedule-table tr.awards {
            background-color: var(--awards-color);
            font-weight: bold;
        }
        
        .schedule-table tr.workshop {
            background-color: var(--workshop-color);
        }
        
        .schedule-table tr.meeting {
            background-color: var(--meeting-color);
        }
        
        /* Highlight the selected dancer's performances */
        .schedule-table tr.highlighted-dancer {
            border-left: 4px solid var(--primary-color);
        }
        
        /* Time columns styling */
        .time-column {
            white-space: nowrap;
            font-weight: bold;
        }
        
        .arrival-time {
            color: var(--warning-color);
        }
        
        .run-through-time {
            color: var(--secondary-color);
        }
        
        .performance-time {
            color: var(--primary-color);
        }
        
        /* Props indicator */
        .props-indicator {
            padding: 0.25rem 0.5rem;
            border-radius: 3px;
            font-size: 0.8rem;
            font-weight: bold;
            white-space: nowrap;
        }
        
        .props-yes {
            background-color: #ffebee;
            color: #c62828;
        }
        
        .props-no {
            background-color: #e8f5e9;
            color: #2e7d32;
        }
        
        /* Time instructions */
        .time-instructions {
            background-color: white;
            padding: 1rem;
            margin-bottom: 1.5rem;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .time-instructions h3 {
            color: var(--primary-color);
            margin-bottom: 0.5rem;
        }
        
        .time-instructions ul {
            padding-left: 1.5rem;
        }
        
        .time-instructions li {
            margin-bottom: 0.5rem;
        }
        
        /* Loading indicator */
        .loading {
            text-align: center;
            padding: 2rem;
            font-size: 1.2rem;
            color: var(--primary-color);
        }
        
        /* Status message */
        .status {
            background-color: var(--success-color);
            color: white;
            padding: 0.5rem;
            border-radius: 4px;
            margin-bottom: 1rem;
            text-align: center;
        }
        
        /* Footer Styles */
        footer {
            background-color: var(--dark-color);
            color: white;
            text-align: center;
            padding: 1.5rem;
            margin-top: 2rem;
        }
        
        footer p {
            margin-bottom: 0.5rem;
        }
        
        /* Container for the main content */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 1rem;
        }
        
        /* Responsive Styles */
        @media (max-width: 768px) {
            .controls {
                flex-direction: column;
                align-items: stretch;
                gap: 0.5rem;
            }
            
            .day-tab {
                padding: 0.5rem 1rem;
                font-size: 0.9rem;
            }
            
            .schedule-table th, .schedule-table td {
                padding: 0.5rem;
                font-size: 0.9rem;
            }
            
            .schedule-table td {
                word-break: break-word;
            }
            
            header h1 {
                font-size: 1.5rem;
            }
            
            header h2 {
                font-size: 1.1rem;
            }
            
            .time-instructions h3 {
                font-size: 1.2rem;
            }
            
            /* Highlight award ceremonies more on mobile */
            .schedule-table tr.awards {
                font-weight: bold;
                font-size: 1em;
            }
            
            /* Better spacing for mobile */
            .schedule-container {
                margin-bottom: 1rem;
            }
            
            /* Improve legends display on mobile */
            .legend {
                gap: 5px;
            }
            
            .legend-item {
                font-size: 0.8rem;
                margin-right: 5px;
            }
        }
        
        /* Additional styles for very small screens (phones) */
        @media (max-width: 480px) {
            .container {
                padding: 0.5rem;
            }
            
            .day-tabs {
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
                white-space: nowrap;
                padding-bottom: 10px;
                margin-bottom: 0.5rem;
            }
            
            .day-tab {
                padding: 0.4rem 0.8rem;
                font-size: 0.8rem;
                display: inline-block;
            }
            
            /* Stack the important columns for better readability */
            .schedule-table, .schedule-table tbody {
                display: block;
                width: 100%;
            }
            
            .schedule-table thead {
                display: none; /* Hide table headers */
            }
            
            .schedule-table tr {
                display: block;
                border: 1px solid #ddd;
                margin-bottom: 0.5rem;
                padding: 0.5rem;
                border-radius: 4px;
            }
            
            .schedule-table td {
                display: block;
                text-align: right;
                padding: 0.25rem 0.5rem;
                position: relative;
                min-height: 20px;
            }
            
            /* Add labels for each cell */
            .schedule-table td:before {
                content: attr(data-label);
                position: absolute;
                left: 0.5rem;
                font-weight: bold;
                text-align: left;
            }
            
            /* Specific styling for main items */
            .schedule-table td.performance-time {
                font-size: 1.1rem;
                text-align: center;
                border-bottom: 1px solid #ddd;
                margin-bottom: 0.25rem;
                padding-bottom: 0.5rem;
                color: var(--primary-color);
            }
            
            .quick-reference, .time-instructions {
                padding: 0.75rem;
            }
            
            /* Make award cells very clear */
            .schedule-table tr.awards td {
                text-align: center;
                font-weight: bold;
            }
            
            .schedule-table tr.awards td:before {
                position: relative;
                display: block;
                text-align: center;
                margin-bottom: 0.25rem;
            }
            
            /* Adjust fonts for better readability */
            body {
                font-size: 14px;
            }
        }
        
        /* Print Styles */
        @media print {
            .controls, .day-tabs, .legend, .status {
                display: none;
            }
            
            header, footer {
                text-align: center;
                padding: 0.5rem;
                margin: 0;
            }
            
            .container {
                padding: 0;
                max-width: 100%;
            }
            
            .schedule-container {
                overflow-x: visible;
            }
            
            .schedule-table {
                font-size: 10pt;
                width: 100%;
                box-shadow: none;
            }
            
            .schedule-table th, .schedule-table td {
                padding: 3pt;
            }
            
            body {
                background-color: white;
            }
            
            .quick-reference {
                border: 1px solid #ddd;
                background-color: white;
                padding: 0.5rem;
                margin-bottom: 0.5rem;
            }
            
            .time-instructions {
                box-shadow: none;
                border: 1px solid #ddd;
                padding: 0.5rem;
            }
        }
    </style>
</head>
<body>
    <header>
        <h1>Denise Wall Dance Energy</h1>
        <h2>Hollywood Vibe Competition Schedule</h2>
        <div class="location-dates">
            <p>April 11-13, 2025 | Hilton Norfolk</p>
        </div>
    </header>
    
    <div class="container">
        <div class="status" id="status-message">
            Schedule data loaded successfully!
        </div>
        
        <div class="controls">
            <div class="filter-controls">
                <select id="dancer-filter">
                    <option value="all">All Dancers</option>
                    <!-- Dancer options will be populated by JavaScript -->
                </select>
                
                <select id="activity-filter">
                    <option value="all">All Activities</option>
                    <option value="Performance">Performances Only</option>
                    <option value="Workshop">Workshops Only</option>
                    <option value="Meeting">Meetings Only</option>
                    <option value="Award">Awards Only</option>
                </select>
                
                <select id="view-mode">
                    <option value="days">View by Days</option>
                    <option value="full">Full Schedule</option>
                </select>
            </div>
            
            <div class="button-controls">
                <button class="btn-print" id="export-pdf">
                    <i class="fas fa-file-pdf"></i> Export PDF/Print
                </button>
                
                <button class="btn-edit" id="toggle-edit-mode">
                    <i class="fas fa-edit"></i> Edit Schedule
                </button>
            </div>
        </div>

        <!-- Edit Controls -->
        <div class="edit-controls" id="edit-controls">
            <div class="edit-message">Edit Mode: Click on <strong>Arrival</strong> or <strong>Run-Through</strong> times to customize them</div>
            <button id="save-changes" class="btn-save">
                <i class="fas fa-save"></i> Save Changes
            </button>
            <button id="cancel-edit" class="btn-secondary">
                <i class="fas fa-times"></i> Cancel
            </button>
        </div>

        <!-- Password Modal for Edit Access -->
        <div id="password-modal" class="modal">
            <div class="modal-content">
                <h3>Enter Password</h3>
                <p>Please enter the password to edit the schedule:</p>
                <input type="password" id="edit-password" class="password-input" placeholder="Password">
                <div class="modal-buttons">
                    <button id="submit-password" class="btn-primary">Submit</button>
                    <button id="cancel-password" class="btn-secondary">Cancel</button>
                </div>
                <p id="password-error" class="error-message"></p>
            </div>
        </div>
        
        <!-- PDF Print Options Modal -->
        <div id="print-modal" class="modal">
            <div class="modal-content">
                <span class="close-modal">&times;</span>
                <h3>Export Schedule Options</h3>
                <div class="print-options">
                    <div class="option-group">
                        <h4>Content Options</h4>
                        <label><input type="checkbox" id="print-include-header" checked> Include Header</label>
                        <label><input type="checkbox" id="print-include-legend" checked> Include Legend</label>
                        <label><input type="checkbox" id="print-include-instructions" checked> Include Instructions</label>
                    </div>
                    
                    <div class="option-group">
                        <h4>Layout Options</h4>
                        <label><input type="radio" name="print-layout" id="print-compact" value="compact"> Compact View</label>
                        <label><input type="radio" name="print-layout" id="print-detailed" value="detailed" checked> Detailed View</label>
                    </div>
                    
                    <div class="option-group">
                        <h4>Page Options</h4>
                        <label><input type="checkbox" id="print-page-numbers" checked> Show Page Numbers</label>
                        <label><input type="checkbox" id="print-auto-break" checked> Optimize Page Breaks</label>
                    </div>
                </div>
                <div class="print-buttons">
                    <button id="preview-pdf" class="btn-secondary"><i class="fas fa-eye"></i> Preview</button>
                    <button id="generate-pdf" class="btn-primary"><i class="fas fa-print"></i> Print/Export</button>
                </div>
            </div>
        </div>
        
        <div class="day-tabs">
            <!-- Day tabs will be populated by JavaScript -->
        </div>
        
        <div id="quick-ref" class="quick-reference">
            <!-- Quick Reference information will be populated by JavaScript -->
        </div>
        
        <div class="legend">
            <!-- Legend will be populated by JavaScript -->
        </div>
        
        <div id="schedule-view">
            <div class="loading">Loading schedule data...</div>
            <!-- Schedule tables will be populated by JavaScript -->
        </div>
    </div>
    
    <footer>
        <p>Denise Wall Dance Energy</p>
        <p>Phone: (757) 555-1234 | Email: info@denisewallsdanceenergy.com</p>
        <p>Studio Address: 123 Dance Street, Virginia Beach, VA 23456</p>
    </footer>

    <script>
        // This is the embedded schedule data directly from the JSON file
        const scheduleData = [
  {
    "Day": "Friday",
    "Date": "4/11/2025",
    "Competition Session": "JR/PRE-TEEN SOLO + PRE-TEEN/TEEN DUO/TRIO COMPETITION",
    "Est. Performance Time": "8:36 AM",
    "Routine Number": 35,
    "Routine Name": "The Stranded",
    "Category": "Pre-Teen Solo Contemporary",
    "Num Dancers": 1,
    "Dancer Names": "Paisley Reich",
    "Choreographer": "Travis Wall",
    "Props": "Yes, Small Prop",
    "Activity Type": "Performance",
    "Studio Arrival Time": "",
    "Studio Warm-up Time": "",
    "Studio Run-through Time": "",
    "Studio Notes": ""
  },
  {
    "Day": "Friday",
    "Date": "4/11/2025",
    "Competition Session": "JR/PRE-TEEN SOLO + PRE-TEEN/TEEN DUO/TRIO COMPETITION",
    "Est. Performance Time": "8:44 AM",
    "Routine Number": 38,
    "Routine Name": "So Broken",
    "Category": "Pre-Teen Solo Contemporary",
    "Num Dancers": 1,
    "Dancer Names": "Keringtyn Spencer",
    "Choreographer": "Travis Wall",
    "Props": "No",
    "Activity Type": "Performance",
    "Studio Arrival Time": "",
    "Studio Warm-up Time": "",
    "Studio Run-through Time": "",
    "Studio Notes": ""
  },
  {
    "Day": "Friday",
    "Date": "4/11/2025",
    "Competition Session": "JR/PRE-TEEN SOLO + PRE-TEEN/TEEN DUO/TRIO COMPETITION",
    "Est. Performance Time": "8:53 AM",
    "Routine Number": 41,
    "Routine Name": "Rework",
    "Category": "Pre-Teen Solo Contemporary",
    "Num Dancers": 1,
    "Dancer Names": "Anna Doebert",
    "Choreographer": "Travis Wall",
    "Props": "No",
    "Activity Type": "Performance",
    "Studio Arrival Time": "",
    "Studio Warm-up Time": "",
    "Studio Run-through Time": "",
    "Studio Notes": ""
  },
  {
    "Day": "Friday",
    "Date": "4/11/2025",
    "Competition Session": "JR/PRE-TEEN SOLO + PRE-TEEN/TEEN DUO/TRIO COMPETITION",
    "Est. Performance Time": "9:01 AM",
    "Routine Number": 44,
    "Routine Name": "Hold Your Breath",
    "Category": "Pre-Teen Solo Contemporary",
    "Num Dancers": 1,
    "Dancer Names": "Anna Oddo",
    "Choreographer": "Cami Walton",
    "Props": "No",
    "Activity Type": "Performance",
    "Studio Arrival Time": "",
    "Studio Warm-up Time": "",
    "Studio Run-through Time": "",
    "Studio Notes": ""
  },
  {
    "Day": "Friday",
    "Date": "4/11/2025",
    "Competition Session": "JR/PRE-TEEN SOLO + PRE-TEEN/TEEN DUO/TRIO COMPETITION",
    "Est. Performance Time": "9:10 AM",
    "Routine Number": 47,
    "Routine Name": "Like Water",
    "Category": "Pre-Teen Solo Contemporary",
    "Num Dancers": 1,
    "Dancer Names": "Emma Ford",
    "Choreographer": "Cami Walton",
    "Props": "No",
    "Activity Type": "Performance",
    "Studio Arrival Time": "",
    "Studio Warm-up Time": "",
    "Studio Run-through Time": "",
    "Studio Notes": ""
  },
  {
    "Day": "Friday",
    "Date": "4/11/2025",
    "Competition Session": "JR/PRE-TEEN SOLO + PRE-TEEN/TEEN DUO/TRIO COMPETITION",
    "Est. Performance Time": "9:18 AM",
    "Routine Number": 50,
    "Routine Name": "Misty",
    "Category": "Pre-Teen Solo Contemporary",
    "Num Dancers": 1,
    "Dancer Names": "Elara Zamani",
    "Choreographer": "Sydni Manley",
    "Props": "No",
    "Activity Type": "Performance",
    "Studio Arrival Time": "",
    "Studio Warm-up Time": "",
    "Studio Run-through Time": "",
    "Studio Notes": ""
  },
  {
    "Day": "Friday",
    "Date": "4/11/2025",
    "Competition Session": "JR/PRE-TEEN SOLO + PRE-TEEN/TEEN DUO/TRIO COMPETITION",
    "Est. Performance Time": "9:27 AM",
    "Routine Number": 53,
    "Routine Name": "Please I Have Only This",
    "Category": "Pre-Teen Solo Contemporary",
    "Num Dancers": 1,
    "Dancer Names": "Charleigh Reich",
    "Choreographer": "Travis Wall",
    "Props": "No",
    "Activity Type": "Performance",
    "Studio Arrival Time": "",
    "Studio Warm-up Time": "",
    "Studio Run-through Time": "",
    "Studio Notes": ""
  },
  {
    "Day": "Friday",
    "Date": "4/11/2025",
    "Competition Session": "JR/PRE-TEEN SOLO + PRE-TEEN/TEEN DUO/TRIO COMPETITION",
    "Est. Performance Time": "9:33 AM",
    "Routine Number": 55,
    "Routine Name": "Cologne",
    "Category": "Pre-Teen Solo Contemporary",
    "Num Dancers": 1,
    "Dancer Names": "Lily Anna King",
    "Choreographer": "Karly Gillespie",
    "Props": "No",
    "Activity Type": "Performance",
    "Studio Arrival Time": "",
    "Studio Warm-up Time": "",
    "Studio Run-through Time": "",
    "Studio Notes": ""
  },
  {
    "Day": "Friday",
    "Date": "4/11/2025",
    "Competition Session": "SENIOR SOLO COMPETITION",
    "Est. Performance Time": "1:15 PM",
    "Routine Number": 117,
    "Routine Name": "Don't Walk Away",
    "Category": "Senior Solo Contemporary",
    "Num Dancers": 1,
    "Dancer Names": "Casey  Mckenna",
    "Choreographer": "Travis Wall",
    "Props": "No",
    "Activity Type": "Performance",
    "Studio Arrival Time": "",
    "Studio Warm-up Time": "",
    "Studio Run-through Time": "",
    "Studio Notes": ""
  },
  {
    "Day": "Friday",
    "Date": "4/11/2025",
    "Competition Session": "SENIOR SOLO COMPETITION",
    "Est. Performance Time": "1:35 PM",
    "Routine Number": 124,
    "Routine Name": "Hannah Tba",
    "Category": "Senior Solo Contemporary",
    "Num Dancers": 1,
    "Dancer Names": "Hannah White",
    "Choreographer": "Travis Wall",
    "Props": "No",
    "Activity Type": "Performance",
    "Studio Arrival Time": "",
    "Studio Warm-up Time": "",
    "Studio Run-through Time": "",
    "Studio Notes": ""
  },
  {
    "Day": "Friday",
    "Date": "4/11/2025",
    "Competition Session": "SENIOR SOLO COMPETITION",
    "Est. Performance Time": "1:55 PM",
    "Routine Number": 131,
    "Routine Name": "This New Space",
    "Category": "Senior Solo Contemporary",
    "Num Dancers": 1,
    "Dancer Names": "Lila Kai Ashley",
    "Choreographer": "Travis Wall",
    "Props": "No",
    "Activity Type": "Performance",
    "Studio Arrival Time": "",
    "Studio Warm-up Time": "",
    "Studio Run-through Time": "",
    "Studio Notes": ""
  },
  {
    "Day": "Friday",
    "Date": "4/11/2025",
    "Competition Session": "SENIOR SOLO COMPETITION",
    "Est. Performance Time": "2:20 PM",
    "Routine Number": 140,
    "Routine Name": "The First Time",
    "Category": "Senior Solo Contemporary",
    "Num Dancers": 1,
    "Dancer Names": "Jaslyn Proctor",
    "Choreographer": "Travis Wall",
    "Props": "No",
    "Activity Type": "Performance",
    "Studio Arrival Time": "",
    "Studio Warm-up Time": "",
    "Studio Run-through Time": "",
    "Studio Notes": ""
  },
  {
    "Day": "Friday",
    "Date": "4/11/2025",
    "Competition Session": "SENIOR SOLO COMPETITION",
    "Est. Performance Time": "2:43 PM",
    "Routine Number": 148,
    "Routine Name": "I Might Say Something Stupid",
    "Category": "Senior Solo Contemporary",
    "Num Dancers": 1,
    "Dancer Names": "Ava Lee Kaufman",
    "Choreographer": "Travis Wall",
    "Props": "No",
    "Activity Type": "Performance",
    "Studio Arrival Time": "",
    "Studio Warm-up Time": "",
    "Studio Run-through Time": "",
    "Studio Notes": ""
  },
  {
    "Day": "Friday",
    "Date": "4/11/2025",
    "Competition Session": "SENIOR SOLO COMPETITION",
    "Est. Performance Time": "3:03 PM",
    "Routine Number": 155,
    "Routine Name": "Nothing",
    "Category": "Senior Solo Contemporary",
    "Num Dancers": 1,
    "Dancer Names": "Ellen Grace Olansen",
    "Choreographer": "Travis Wall",
    "Props": "No",
    "Activity Type": "Performance",
    "Studio Arrival Time": "",
    "Studio Warm-up Time": "",
    "Studio Run-through Time": "",
    "Studio Notes": ""
  },
  {
    "Day": "Friday",
    "Date": "4/11/2025",
    "Competition Session": "SENIOR SOLO COMPETITION",
    "Est. Performance Time": "3:17 PM",
    "Routine Number": 160,
    "Routine Name": "I Gotta Find Peace Of Mind",
    "Category": "Senior Solo Contemporary",
    "Num Dancers": 1,
    "Dancer Names": "Myla Smith",
    "Choreographer": "Travis Wall",
    "Props": "No",
    "Activity Type": "Performance",
    "Studio Arrival Time": "",
    "Studio Warm-up Time": "",
    "Studio Run-through Time": "",
    "Studio Notes": ""
  },
  {
    "Day": "Friday",
    "Date": "4/11/2025",
    "Competition Session": "SENIOR SOLO COMPETITION",
    "Est. Performance Time": "3:45 PM",
    "Routine Number": 170,
    "Routine Name": "Poinciana",
    "Category": "Senior Solo Tap",
    "Num Dancers": 1,
    "Dancer Names": "Caroline Sison",
    "Choreographer": "Anthony Morigerato",
    "Props": "Yes, Big Props",
    "Activity Type": "Performance",
    "Studio Arrival Time": "",
    "Studio Warm-up Time": "",
    "Studio Run-through Time": "",
    "Studio Notes": ""
  },
  {
    "Day": "Friday",
    "Date": "4/11/2025",
    "Competition Session": "TEEN SOLO + SR DUO/TRIO + SR SM GROUP COMPETITION",
    "Est. Performance Time": "7:05 PM",
    "Routine Number": 224,
    "Routine Name": "O God Protect Me",
    "Category": "Teen Solo Contemporary",
    "Num Dancers": 1,
    "Dancer Names": "Lulu Gandia",
    "Choreographer": "Travis Wall",
    "Props": "No",
    "Activity Type": "Performance",
    "Studio Arrival Time": "",
    "Studio Warm-up Time": "",
    "Studio Run-through Time": "",
    "Studio Notes": ""
  },
  {
    "Day": "Friday",
    "Date": "4/11/2025",
    "Competition Session": "TEEN SOLO + SR DUO/TRIO + SR SM GROUP COMPETITION",
    "Est. Performance Time": "9:26 PM",
    "Routine Number": 273,
    "Routine Name": "Begin The Beguine",
    "Category": "Senior Small Group Tap",
    "Num Dancers": 9,
    "Dancer Names": "Lila Kai Ashley, Lulu Gandia, Ava Lee Kaufman, Casey  Mckenna, Ellen Grace Olansen, Jaslyn Proctor, Caroline Sison, Myla Smith, Hannah White",
    "Choreographer": "Anthony Morigerato",
    "Props": "Yes, Big Props",
    "Activity Type": "Performance",
    "Studio Arrival Time": "",
    "Studio Warm-up Time": "",
    "Studio Run-through Time": "",
    "Studio Notes": ""
  },
  {
    "Day": "Friday",
    "Date": "4/11/2025",
    "Competition Session": "TEEN SOLO + SR DUO/TRIO + SR SM GROUP COMPETITION",
    "Est. Performance Time": "9:45 PM",
    "Routine Number": 279,
    "Routine Name": "Zombie",
    "Category": "Senior Small Group Contemporary",
    "Num Dancers": 9,
    "Dancer Names": "Lila Kai Ashley, Lulu Gandia, Ava Lee Kaufman, Casey  Mckenna, Ellen Grace Olansen, Jaslyn Proctor, Caroline Sison, Myla Smith, Hannah White",
    "Choreographer": "Travis Wall",
    "Props": "No",
    "Activity Type": "Performance",
    "Studio Arrival Time": "",
    "Studio Warm-up Time": "",
    "Studio Run-through Time": "",
    "Studio Notes": ""
  },
  {
    "Day": "Friday",
    "Date": "4/11/2025",
    "Competition Session": "TEEN SOLO + SR DUO/TRIO + SR SM GROUP COMPETITION",
    "Est. Performance Time": "10:15 PM",
    "Routine Number": 289,
    "Routine Name": "Heaven I Know",
    "Category": "Senior Small Group Lyrical",
    "Num Dancers": 9,
    "Dancer Names": "Lila Kai Ashley, Lulu Gandia, Ava Lee Kaufman, Casey  Mckenna, Ellen Grace Olansen, Jaslyn Proctor, Caroline Sison, Myla Smith, Hannah White",
    "Choreographer": "Cami Walton",
    "Props": "No",
    "Activity Type": "Performance",
    "Studio Arrival Time": "",
    "Studio Warm-up Time": "",
    "Studio Run-through Time": "",
    "Studio Notes": ""
  },
  {
    "Day": "Saturday",
    "Date": "4/12/2025",
    "Competition Session": "MINI/JR/PRE-TEEN COMPETITION",
    "Est. Performance Time": "2:59 PM",
    "Routine Number": 299,
    "Routine Name": "Dance With Me",
    "Category": "Junior Small Group Jazz",
    "Num Dancers": 6,
    "Dancer Names": "Matilda Brown, Zaedith Ghacham, Clara Nigbur, Victoria Rodriguez, Khloe Taylor, Ryatt Weinberg",
    "Choreographer": "Cami Walton",
    "Props": "No",
    "Activity Type": "Performance",
    "Studio Arrival Time": "",
    "Studio Warm-up Time": "",
    "Studio Run-through Time": "",
    "Studio Notes": ""
  },
  {
    "Day": "Saturday",
    "Date": "4/12/2025",
    "Competition Session": "MINI/JR/PRE-TEEN COMPETITION",
    "Est. Performance Time": "3:20 PM",
    "Routine Number": 306,
    "Routine Name": "A Petite Suite",
    "Category": "Junior Small Group Ballet/Pointe",
    "Num Dancers": 6,
    "Dancer Names": "Matilda Brown, Zaedith Ghacham, Clara Nigbur, Victoria Rodriguez, Khloe Taylor, Ryatt Weinberg",
    "Choreographer": "Aimee McElroy",
    "Props": "No",
    "Activity Type": "Performance",
    "Studio Arrival Time": "",
    "Studio Warm-up Time": "",
    "Studio Run-through Time": "",
    "Studio Notes": ""
  },
  {
    "Day": "Saturday",
    "Date": "4/12/2025",
    "Competition Session": "MINI/JR/PRE-TEEN COMPETITION",
    "Est. Performance Time": "3:39 PM",
    "Routine Number": 312,
    "Routine Name": "Infectious Boogie",
    "Category": "Junior Small Group Hip Hop",
    "Num Dancers": 6,
    "Dancer Names": "Matilda Brown, Zaedith Ghacham, Clara Nigbur, Victoria Rodriguez, Khloe Taylor, Ryatt Weinberg",
    "Choreographer": "Khyre Dean",
    "Props": "No",
    "Activity Type": "Performance",
    "Studio Arrival Time": "",
    "Studio Warm-up Time": "",
    "Studio Run-through Time": "",
    "Studio Notes": ""
  },
  {
    "Day": "Saturday",
    "Date": "4/12/2025",
    "Competition Session": "MINI/JR/PRE-TEEN COMPETITION",
    "Est. Performance Time": "3:45 PM",
    "Routine Number": 314,
    "Routine Name": "The Way That You Love Me",
    "Category": "Pre-Teen Small Group Jazz",
    "Num Dancers": 8,
    "Dancer Names": "Anna Doebert, Emma Ford, Lily Anna King, Anna Oddo, Charleigh Reich, Paisley Reich, Keringtyn Spencer, Elara Zamani",
    "Choreographer": "Cami Walton",
    "Props": "No",
    "Activity Type": "Performance",
    "Studio Arrival Time": "",
    "Studio Warm-up Time": "",
    "Studio Run-through Time": "",
    "Studio Notes": ""
  },
  {
    "Day": "Saturday",
    "Date": "4/12/2025",
    "Competition Session": "MINI/JR/PRE-TEEN COMPETITION",
    "Est. Performance Time": "4:03 PM",
    "Routine Number": 320,
    "Routine Name": "L'apres-Midi",
    "Category": "Pre-Teen Small Group Ballet/Pointe",
    "Num Dancers": 8,
    "Dancer Names": "Anna Doebert, Emma Ford, Lily Anna King, Anna Oddo, Charleigh Reich, Paisley Reich, Keringtyn Spencer, Elara Zamani",
    "Choreographer": "Aimee McElroy",
    "Props": "No",
    "Activity Type": "Performance",
    "Studio Arrival Time": "",
    "Studio Warm-up Time": "",
    "Studio Run-through Time": "",
    "Studio Notes": ""
  },
  {
    "Day": "Saturday",
    "Date": "4/12/2025",
    "Competition Session": "MINI/JR/PRE-TEEN COMPETITION",
    "Est. Performance Time": "4:28 PM",
    "Routine Number": 328,
    "Routine Name": "News Of The Fall",
    "Category": "Pre-Teen Small Group Contemporary",
    "Num Dancers": 9,
    "Dancer Names": "Anna Doebert, Emma Ford, Lulu Gandia, Lily Anna King, Anna Oddo, Charleigh Reich, Paisley Reich, Keringtyn Spencer, Elara Zamani",
    "Choreographer": "Travis Wall",
    "Props": "Yes, Big Props",
    "Activity Type": "Performance",
    "Studio Arrival Time": "",
    "Studio Warm-up Time": "",
    "Studio Run-through Time": "",
    "Studio Notes": ""
  },
  {
    "Day": "Saturday",
    "Date": "4/12/2025",
    "Competition Session": "MINI/JR/PRE-TEEN COMPETITION",
    "Est. Performance Time": "4:47 PM",
    "Routine Number": 334,
    "Routine Name": "Billy Boy",
    "Category": "Pre-Teen Small Group Tap",
    "Num Dancers": 8,
    "Dancer Names": "Anna Doebert, Emma Ford, Lily Anna King, Anna Oddo, Charleigh Reich, Paisley Reich, Keringtyn Spencer, Elara Zamani",
    "Choreographer": "Anthony Morigerato",
    "Props": "No",
    "Activity Type": "Performance",
    "Studio Arrival Time": "",
    "Studio Warm-up Time": "",
    "Studio Run-through Time": "",
    "Studio Notes": ""
  },
  {
    "Day": "Saturday",
    "Date": "4/12/2025",
    "Competition Session": "MINI/JR/PRE-TEEN COMPETITION",
    "Est. Performance Time": "5:10 PM",
    "Routine Number": 341,
    "Routine Name": "Bounce Out",
    "Category": "Pre-Teen Small Group Hip Hop",
    "Num Dancers": 8,
    "Dancer Names": "Anna Doebert, Emma Ford, Lily Anna King, Anna Oddo, Charleigh Reich, Paisley Reich, Keringtyn Spencer, Elara Zamani",
    "Choreographer": "Julika Cuffy",
    "Props": "No",
    "Activity Type": "Performance",
    "Studio Arrival Time": "",
    "Studio Warm-up Time": "",
    "Studio Run-through Time": "",
    "Studio Notes": ""
  },
  {
    "Day": "Saturday",
    "Date": "4/12/2025",
    "Competition Session": "MINI/JR/PRE-TEEN COMPETITION",
    "Est. Performance Time": "5:30 PM",
    "Routine Number": 347,
    "Routine Name": "Wild Horses",
    "Category": "Pre-Teen Small Group Lyrical",
    "Num Dancers": 9,
    "Dancer Names": "Anna Doebert, Emma Ford, Lulu Gandia, Lily Anna King, Anna Oddo, Charleigh Reich, Paisley Reich, Keringtyn Spencer, Elara Zamani",
    "Choreographer": "Cami Walton",
    "Props": "No",
    "Activity Type": "Performance",
    "Studio Arrival Time": "",
    "Studio Warm-up Time": "",
    "Studio Run-through Time": "",
    "Studio Notes": ""
  },
  {
    "Day": "Saturday",
    "Date": "4/12/2025",
    "Competition Session": "TEEN/SENIOR COMPETITION",
    "Est. Performance Time": "8:06 PM",
    "Routine Number": 377,
    "Routine Name": "Heaven's Gates",
    "Category": "Teen Large Group Jazz",
    "Num Dancers": 13,
    "Dancer Names": "Lila Kai Ashley, Anna Doebert, Lulu Gandia, Ava Lee Kaufman, Casey  Mckenna, Ellen Grace Olansen, Jaslyn Proctor, Charleigh Reich, Paisley Reich, Caroline Sison, Myla Smith, Keringtyn Spencer, Hannah White",
    "Choreographer": "Will Loftis",
    "Props": "No",
    "Activity Type": "Performance",
    "Studio Arrival Time": "",
    "Studio Warm-up Time": "",
    "Studio Run-through Time": "",
    "Studio Notes": ""
  },
  {
    "Day": "Saturday",
    "Date": "4/12/2025",
    "Competition Session": "TEEN/SENIOR COMPETITION",
    "Est. Performance Time": "8:26 PM",
    "Routine Number": 383,
    "Routine Name": "Grande Waltz",
    "Category": "Teen Large Group Ballet/Pointe",
    "Num Dancers": 12,
    "Dancer Names": "Lila Kai Ashley, Anna Doebert, Lulu Gandia, Ava Lee Kaufman, Casey  Mckenna, Ellen Grace Olansen, Jaslyn Proctor, Charleigh Reich, Caroline Sison, Myla Smith, Keringtyn Spencer, Hannah White",
    "Choreographer": "Aimee McElroy",
    "Props": "No",
    "Activity Type": "Performance",
    "Studio Arrival Time": "",
    "Studio Warm-up Time": "",
    "Studio Run-through Time": "",
    "Studio Notes": ""
  },
  {
    "Day": "Saturday",
    "Date": "4/12/2025",
    "Competition Session": "TEEN/SENIOR COMPETITION",
    "Est. Performance Time": "8:47 PM",
    "Routine Number": 389,
    "Routine Name": "Live From Mars",
    "Category": "Teen Line Hip Hop",
    "Num Dancers": 17,
    "Dancer Names": "Lila Kai Ashley, Anna Doebert, Emma Ford, Lulu Gandia, Ava Lee Kaufman, Lily Anna King, Casey  Mckenna, Anna Oddo, Ellen Grace Olansen, Jaslyn Proctor, Charleigh Reich, Paisley Reich, Caroline Sison, Myla Smith, Keringtyn Spencer, Hannah White, Elara Zamani",
    "Choreographer": "Xavier Tu",
    "Props": "Yes, Big Props",
    "Activity Type": "Performance",
    "Studio Arrival Time": "",
    "Studio Warm-up Time": "",
    "Studio Run-through Time": "",
    "Studio Notes": ""
  },
  {
    "Day": "Saturday",
    "Date": "4/12/2025",
    "Competition Session": "TEEN/SENIOR COMPETITION",
    "Est. Performance Time": "9:50 PM",
    "Routine Number": 407,
    "Routine Name": "Express Yourself",
    "Category": "Teen Line Jazz",
    "Num Dancers": 17,
    "Dancer Names": "Lila Kai Ashley, Anna Doebert, Emma Ford, Lulu Gandia, Ava Lee Kaufman, Lily Anna King, Casey  Mckenna, Anna Oddo, Ellen Grace Olansen, Jaslyn Proctor, Charleigh Reich, Paisley Reich, Caroline Sison, Myla Smith, Keringtyn Spencer, Hannah White, Elara Zamani",
    "Choreographer": "Cami Walton",
    "Props": "No",
    "Activity Type": "Performance",
    "Studio Arrival Time": "",
    "Studio Warm-up Time": "",
    "Studio Run-through Time": "",
    "Studio Notes": ""
  },
  {
    "Day": "Friday",
    "Date": "4/11/2025",
    "Competition Session": "JR/PRE-TEEN SOLO + PRE-TEEN/TEEN DUO/TRIO COMPETITION",
    "Est. Performance Time": "12:00 PM",
    "Routine Number": 999,
    "Routine Name": "Junior & Pre-Teen Solos + Pre-Teen/Teen Duo-Trio Competition Awards",
    "Category": "Awards Ceremony",
    "Num Dancers": 99,
    "Dancer Names": "All Dancers",
    "Choreographer": "N/A",
    "Props": "No",
    "Activity Type": "Award",
    "Studio Arrival Time": "",
    "Studio Warm-up Time": "",
    "Studio Run-through Time": "",
    "Studio Notes": "All dancers must attend"
  },
  {
    "Day": "Friday",
    "Date": "4/11/2025",
    "Competition Session": "SENIOR SOLO COMPETITION",
    "Est. Performance Time": "5:30 PM",
    "Routine Number": 999,
    "Routine Name": "Senior Solo Competition Awards",
    "Category": "Awards Ceremony",
    "Num Dancers": 99,
    "Dancer Names": "All Dancers",
    "Choreographer": "N/A",
    "Props": "No",
    "Activity Type": "Award",
    "Studio Arrival Time": "",
    "Studio Warm-up Time": "",
    "Studio Run-through Time": "",
    "Studio Notes": "All dancers must attend"
  },
  {
    "Day": "Friday",
    "Date": "4/11/2025",
    "Competition Session": "TEEN SOLO + SR DUO/TRIO + SR SM GROUP COMPETITION",
    "Est. Performance Time": "10:45 PM",
    "Routine Number": 999,
    "Routine Name": "Teen Solos + Senior Duo-Trio + Senior Sm. Group Competition Awards",
    "Category": "Awards Ceremony",
    "Num Dancers": 99,
    "Dancer Names": "All Dancers",
    "Choreographer": "N/A",
    "Props": "No",
    "Activity Type": "Award",
    "Studio Arrival Time": "",
    "Studio Warm-up Time": "",
    "Studio Run-through Time": "",
    "Studio Notes": "All dancers must attend"
  },
  {
    "Day": "Saturday",
    "Date": "4/12/2025",
    "Competition Session": "MINI/JR/PRE-TEEN COMPETITION",
    "Est. Performance Time": "6:15 PM",
    "Routine Number": 999,
    "Routine Name": "Mini/Junior/Pre-Teen Competition Awards",
    "Category": "Awards Ceremony",
    "Num Dancers": 99,
    "Dancer Names": "All Dancers",
    "Choreographer": "N/A",
    "Props": "No",
    "Activity Type": "Award",
    "Studio Arrival Time": "",
    "Studio Warm-up Time": "",
    "Studio Run-through Time": "",
    "Studio Notes": "All dancers must attend"
  },
  {
    "Day": "Saturday",
    "Date": "4/12/2025",
    "Competition Session": "TEEN/SENIOR COMPETITION",
    "Est. Performance Time": "11:00 PM",
    "Routine Number": 999,
    "Routine Name": "Teen/Senior Competition Awards",
    "Category": "Awards Ceremony",
    "Num Dancers": 99,
    "Dancer Names": "All Dancers",
    "Choreographer": "N/A",
    "Props": "No",
    "Activity Type": "Award",
    "Studio Arrival Time": "",
    "Studio Warm-up Time": "",
    "Studio Run-through Time": "",
    "Studio Notes": "All dancers must attend"
  },
  {
    "Day": "Sunday",
    "Date": "4/13/2025",
    "Competition Session": "SCHOLARSHIP FINALE",
    "Est. Performance Time": "2:30 PM",
    "Routine Number": 999,
    "Routine Name": "Scholarship Finale & Closing Show",
    "Category": "Awards Ceremony",
    "Num Dancers": 99,
    "Dancer Names": "All Dancers",
    "Choreographer": "N/A",
    "Props": "No",
    "Activity Type": "Award",
    "Studio Arrival Time": "",
    "Studio Warm-up Time": "",
    "Studio Run-through Time": "",
    "Studio Notes": "All dancers must attend"
  }
];

        // Initialize the schedule after data is loaded
        document.addEventListener('DOMContentLoaded', function() {
            // Process dancer names from dancers.js
            processDancerNames();
            
            // Initialize the schedule display
            initializeSchedule();
            
            // Setup export PDF modal functionality
            initializePrintModal();
        });

        // Function to initialize the schedule display
        function initializeSchedule() {
            // Extract unique days from schedule data
            const days = [...new Set(scheduleData.map(item => item.Day))];
            
            // Populate day tabs
            const dayTabsContainer = document.querySelector('.day-tabs');
            days.forEach((day, index) => {
                const tab = document.createElement('button');
                tab.className = 'day-tab' + (index === 0 ? ' active' : '');
                tab.textContent = day;
                tab.onclick = () => switchDay(day);
                dayTabsContainer.appendChild(tab);
            });
            
            // Create legend
            createLegend();
            
            // Show first day by default
            if (days.length > 0) {
                switchDay(days[0]);
            }
            
            // Setup event listeners for filters
            document.getElementById('dancer-filter').addEventListener('change', updateScheduleView);
            document.getElementById('activity-filter').addEventListener('change', updateScheduleView);
            document.getElementById('view-mode').addEventListener('change', handleViewModeChange);
            
            // Setup print button
            document.getElementById('export-pdf').addEventListener('click', openPrintModal);
        }
        
        // Function to initialize the print modal
        function initializePrintModal() {
            const modal = document.getElementById('print-modal');
            const closeBtn = document.querySelector('.close-modal');
            const previewBtn = document.getElementById('preview-pdf');
            const generateBtn = document.getElementById('generate-pdf');
            
            // Close modal when clicking the X
            closeBtn.addEventListener('click', () => {
                modal.style.display = 'none';
            });
            
            // Close modal when clicking outside
            window.addEventListener('click', (e) => {
                if (e.target === modal) {
                    modal.style.display = 'none';
                }
            });
            
            // Preview PDF
            previewBtn.addEventListener('click', () => {
                applyPrintStyles(true);
                setTimeout(() => {
                    window.print();
                    restorePrintStyles();
                }, 300);
            });
            
            // Generate PDF
            generateBtn.addEventListener('click', () => {
                applyPrintStyles(false);
                setTimeout(() => {
                    window.print();
                    restorePrintStyles();
                }, 300);
            });
        }
        
        // Open print modal
        function openPrintModal() {
            document.getElementById('print-modal').style.display = 'block';
        }
        
        // Apply print styles based on selected options
        function applyPrintStyles(isPreview) {
            const includeHeader = document.getElementById('print-include-header').checked;
            const includeLegend = document.getElementById('print-include-legend').checked;
            const includeInstructions = document.getElementById('print-include-instructions').checked;
            const isCompact = document.getElementById('print-compact').checked;
            const showPageNumbers = document.getElementById('print-page-numbers').checked;
            const optimizeBreaks = document.getElementById('print-auto-break').checked;
            
            // Create a style element to override print styles
            const styleEl = document.createElement('style');
            styleEl.id = 'custom-print-styles';
            
            let styles = `
                @media print {
                    body { background-color: white; }
                    .container { max-width: 100%; padding: 0; }
                    .controls, .modal, .status { display: none !important; }
                    
                    ${includeHeader ? '.header { display: block !important; }' : 'header { display: none !important; }'}
                    ${includeLegend ? '.legend { display: flex !important; }' : '.legend { display: none !important; }'}
                    ${includeInstructions ? '.time-instructions { display: block !important; }' : '.time-instructions { display: none !important; }'}
                    
                    ${isCompact ? '.schedule-table td, .schedule-table th { padding: 3pt !important; font-size: 9pt !important; }' : ''}
                    ${showPageNumbers ? '@page { margin: 0.5in; @bottom-center { content: "Page " counter(page) " of " counter(pages); } }' : ''}
                    ${optimizeBreaks ? '.schedule-container { page-break-inside: avoid; } h3 { page-break-before: always; }' : ''}
                    
                    /* Common print styles */
                    .schedule-table { width: 100%; border-collapse: collapse; }
                    footer { position: fixed; bottom: 0; width: 100%; font-size: 8pt; }
                }
            `;
            
            styleEl.textContent = styles;
            document.head.appendChild(styleEl);
            
            // Store the current view state to restore later
            window._printViewState = {
                viewMode: document.getElementById('view-mode').value
            };
            
            // Force full schedule view for printing if not in preview mode
            if (!isPreview && window._printViewState.viewMode !== 'full') {
                document.getElementById('view-mode').value = 'full';
                handleViewModeChange();
            }
        }
        
        // Restore original view after printing
        function restorePrintStyles() {
            // Remove custom print styles
            const styleEl = document.getElementById('custom-print-styles');
            if (styleEl) {
                document.head.removeChild(styleEl);
            }
            
            // Restore previous view mode
            if (window._printViewState && window._printViewState.viewMode !== document.getElementById('view-mode').value) {
                document.getElementById('view-mode').value = window._printViewState.viewMode;
                handleViewModeChange();
            }
        }
        
        // Handle view mode change (day view vs full schedule)
        function handleViewModeChange() {
            const viewMode = document.getElementById('view-mode').value;
            const dayTabs = document.querySelector('.day-tabs');
            
            if (viewMode === 'full') {
                // Hide day tabs when in full schedule mode
                dayTabs.style.display = 'none';
                // Show complete schedule
                displayFullSchedule();
            } else {
                // Show day tabs when in day view mode
                dayTabs.style.display = 'flex';
                // Show the active day
                const activeDay = document.querySelector('.day-tab.active')?.textContent || 'Friday';
                switchDay(activeDay);
            }
        }
        
        // Display full schedule with all days
        function displayFullSchedule() {
            const scheduleView = document.getElementById('schedule-view');
            
            // Get current filters
            const selectedDancer = document.getElementById('dancer-filter').value;
            const selectedActivity = document.getElementById('activity-filter').value;
            
            // Filter data for dancer and activity type
            let filteredData = [...scheduleData]; // Clone the array
            
            if (selectedDancer !== 'all') {
                filteredData = filteredData.filter(item =>
                    item['Dancer Names'] && item['Dancer Names'].includes(selectedDancer)
                );
            }
            
            if (selectedActivity !== 'all') {
                filteredData = filteredData.filter(item =>
                    item['Activity Type'] && item['Activity Type'].includes(selectedActivity)
                );
            }
            
            // Sort by date and time
            filteredData.sort((a, b) => {
                // First compare days (Friday, Saturday, Sunday)
                const days = ['Friday', 'Saturday', 'Sunday'];
                const dayComparison = days.indexOf(a.Day) - days.indexOf(b.Day);
                if (dayComparison !== 0) return dayComparison;
                
                // If same day, compare time
                const aTime = convertTimeToMinutes(a['Est. Performance Time']);
                const bTime = convertTimeToMinutes(b['Est. Performance Time']);
                return aTime - bTime;
            });
            
            // Group by day
            const scheduleByDay = {};
            filteredData.forEach(item => {
                if (!scheduleByDay[item.Day]) {
                    scheduleByDay[item.Day] = [];
                }
                scheduleByDay[item.Day].push(item);
            });
            
            // Create HTML for full schedule
            let html = '<div class="full-schedule">';
            
            if (Object.keys(scheduleByDay).length === 0) {
                html = '<div class="no-results">No activities match your filter criteria.</div>';
            } else {
                // Iterate through days in order
                ['Friday', 'Saturday', 'Sunday'].forEach(day => {
                    if (scheduleByDay[day] && scheduleByDay[day].length > 0) {
                        const date = scheduleByDay[day][0].Date;
                        
                        html += `<div class="date-divider">${day}, ${date}</div>`;
                        
                        // Group by competition session within each day
                        const sessions = {};
                        scheduleByDay[day].forEach(item => {
                            const session = item['Competition Session'];
                            if (!sessions[session]) {
                                sessions[session] = [];
                            }
                            sessions[session].push(item);
                        });
                        
                        // Create table for each session
                        Object.entries(sessions).forEach(([session, items]) => {
                            html += `
                                <h3>${session}</h3>
                                <div class="schedule-container">
                                    <table class="schedule-table">
                                        <thead>
                                            <tr>
                                                <th>Time</th>
                                                <th>Routine #</th>
                                                <th>Routine Name</th>
                                                <th>Category</th>
                                                <th>Dancers</th>
                                                <th>Props</th>
                                                <th>Arrival</th>
                                                <th>Run-Through</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                            `;
                            
                            items.forEach(item => {
                                // Determine row class
                                let rowClass = '';
                                const category = item.Category.toLowerCase();
                                const activityType = item['Activity Type'].toLowerCase();
                                
                                if (activityType === 'workshop') rowClass = 'workshop';
                                else if (activityType === 'meeting') rowClass = 'meeting';
                                else if (activityType.includes('award')) rowClass = 'awards';
                                else if (category.includes('solo')) rowClass = 'solo-routine';
                                else if (category.includes('duo') || category.includes('trio')) rowClass = 'duo-trio-routine';
                                else rowClass = 'group-routine';
                                
                                // Add highlighted class if this dancer is selected
                                if (selectedDancer !== 'all' && item['Dancer Names'].includes(selectedDancer)) {
                                    rowClass += ' highlighted-dancer';
                                }
                                
                                // Calculate arrival and run-through times
                                const perfTime = item['Est. Performance Time'];
                                
                                // Check if there's a custom arrival offset
                                let arrivalTime;
                                if (item['Custom Arrival Offset'] !== undefined) {
                                    arrivalTime = calcTimeOffset(perfTime, item['Custom Arrival Offset']);
                                } else {
                                    arrivalTime = calcTimeOffset(perfTime, -150); // Default: 2 hours and 30 minutes before
                                }
                                
                                // Check if there's a custom run-through offset
                                let runThroughTime;
                                if (item['Custom RunThrough Offset'] !== undefined) {
                                    runThroughTime = calcTimeOffset(perfTime, item['Custom RunThrough Offset']);
                                } else {
                                    // Calculate optimal run-through time if no custom value
                                    // Each routine takes about 5 min to perform, run-through needs 15 min
                                    const baseRunThroughMinutes = 60; // Start with 1 hour before as baseline
                                    runThroughTime = calcOptimalRunThroughTime(perfTime, items, baseRunThroughMinutes);
                                }
                                
                                // Props indicator
                                const hasProps = item.Props.toLowerCase().includes('yes');
                                const propsClass = hasProps ? 'props-yes' : 'props-no';
                                const propsText = hasProps ? 'Yes' : 'No';
                                
                                html += `
                                    <tr class="${rowClass}">
                                        <td class="time-column performance-time" data-label="Time">${perfTime}</td>
                                        <td data-label="Routine #">${item['Routine Number']}</td>
                                        <td data-label="Routine">${item['Routine Name']}</td>
                                        <td data-label="Category">${item.Category}</td>
                                        <td data-label="Dancers">${item['Dancer Names']}</td>
                                        <td data-label="Props"><span class="props-indicator ${propsClass}">${propsText}</span></td>
                                        <td class="time-column arrival-time" data-label="Arrival">${arrivalTime}</td>
                                        <td class="time-column run-through-time" data-label="Run-Through">${runThroughTime}</td>
                                    </tr>
                                `;
                            });
                            
                            html += `
                                        </tbody>
                                    </table>
                                </div>
                            `;
                        });
                    }
                });
            }
            
            html += '</div>';
            scheduleView.innerHTML = html;
        }
        
        // Convert time to minutes for sorting
        function convertTimeToMinutes(timeStr) {
            const [hourStr, minuteStr] = timeStr.split(':');
            let hour = parseInt(hourStr);
            const minute = parseInt(minuteStr);
            const isPM = minuteStr.includes('PM');
            
            if (isPM && hour !== 12) {
                hour += 12;
            } else if (!isPM && hour === 12) {
                hour = 0;
            }
            
            return hour * 60 + minute;
        }
        
        // Function to create the legend
        function createLegend() {
            const legendContainer = document.querySelector('.legend');
            legendContainer.innerHTML = ''; // Clear existing content
            
            const legendItems = [
                { name: 'Solo', color: 'var(--solo-color)' },
                { name: 'Duo/Trio', color: 'var(--duo-trio-color)' },
                { name: 'Group', color: 'var(--group-color)' },
                { name: 'Awards', color: 'var(--awards-color)' },
                { name: 'Workshop', color: 'var(--workshop-color)' },
                { name: 'Meeting', color: 'var(--meeting-color)' }
            ];
            
            legendItems.forEach(item => {
                const legendItem = document.createElement('div');
                legendItem.className = 'legend-item';
                
                const colorBox = document.createElement('span');
                colorBox.className = 'legend-color';
                colorBox.style.backgroundColor = item.color;
                
                const label = document.createElement('span');
                label.textContent = item.name;
                
                legendItem.appendChild(colorBox);
                legendItem.appendChild(label);
                legendContainer.appendChild(legendItem);
            });
        }
        
        // Function to switch between days
        function switchDay(day) {
            // Update active tab
            document.querySelectorAll('.day-tab').forEach(tab => {
                tab.classList.toggle('active', tab.textContent === day);
            });
            
            // Update quick reference
            updateQuickReference(day);
            
            // Update schedule view
            updateScheduleView();
        }
        
        // Function to update quick reference info
        function updateQuickReference(day) {
            const dayData = scheduleData.filter(item => item.Day === day);
            const quickRef = document.getElementById('quick-ref');
            
            if (dayData.length > 0) {
                const date = dayData[0].Date;
                const sessions = [...new Set(dayData.map(item => item['Competition Session']))];
                
                let html = `<h3>${day}, ${date} - Quick Reference</h3>`;
                html += '<p><strong>Competition Sessions:</strong></p>';
                sessions.forEach(session => {
                    html += `<p>• ${session}</p>`;
                });
                
                quickRef.innerHTML = html;
                quickRef.style.display = 'block';
            } else {
                quickRef.style.display = 'none';
            }
        }
        
        // Function to update the schedule view based on filters
        function updateScheduleView() {
            const scheduleView = document.getElementById('schedule-view');
            
            // Get current filters
            const selectedDay = document.querySelector('.day-tab.active').textContent;
            const selectedDancer = document.getElementById('dancer-filter').value;
            const selectedActivity = document.getElementById('activity-filter').value;
            
            // Filter data
            let filteredData = scheduleData.filter(item => item.Day === selectedDay);
            
            if (selectedDancer !== 'all') {
                filteredData = filteredData.filter(item =>
                    item['Dancer Names'] && item['Dancer Names'].includes(selectedDancer)
                );
            }
            
            if (selectedActivity !== 'all') {
                filteredData = filteredData.filter(item =>
                    item['Activity Type'] && item['Activity Type'].includes(selectedActivity)
                );
            }
            
            // Group by competition session
            const sessions = {};
            filteredData.forEach(item => {
                const session = item['Competition Session'];
                if (!sessions[session]) {
                    sessions[session] = [];
                }
                sessions[session].push(item);
            });
            
            // Create HTML for schedule tables
            let html = '';
            
            if (Object.keys(sessions).length === 0) {
                html = '<div class="no-results">No activities match your filter criteria.</div>';
            } else {
                Object.entries(sessions).forEach(([session, items]) => {
                    html += `
                        <h3>${session}</h3>
                        <div class="schedule-container">
                            <table class="schedule-table">
                                <thead>
                                    <tr>
                                        <th>Time</th>
                                        <th>Routine #</th>
                                        <th>Routine Name</th>
                                        <th>Category</th>
                                        <th>Dancers</th>
                                        <th>Props</th>
                                        <th>Arrival</th>
                                        <th>Run-Through</th>
                                    </tr>
                                </thead>
                                <tbody>
                    `;
                    
                    items.forEach(item => {
                        // Determine row class
                        let rowClass = '';
                        const category = item.Category.toLowerCase();
                        const activityType = item['Activity Type'].toLowerCase();
                        
                        if (activityType === 'workshop') rowClass = 'workshop';
                        else if (activityType === 'meeting') rowClass = 'meeting';
                        else if (activityType.includes('award')) rowClass = 'awards';
                        else if (category.includes('solo')) rowClass = 'solo-routine';
                        else if (category.includes('duo') || category.includes('trio')) rowClass = 'duo-trio-routine';
                        else rowClass = 'group-routine';
                        
                        // Add highlighted class if this dancer is selected
                        if (selectedDancer !== 'all' && item['Dancer Names'].includes(selectedDancer)) {
                            rowClass += ' highlighted-dancer';
                        }
                        
                        // Calculate arrival and run-through times
                        const perfTime = item['Est. Performance Time'];
                        
                        // Check if there's a custom arrival offset
                        let arrivalTime;
                        if (item['Custom Arrival Offset'] !== undefined) {
                            arrivalTime = calcTimeOffset(perfTime, item['Custom Arrival Offset']);
                        } else {
                            arrivalTime = calcTimeOffset(perfTime, -150); // Default: 2 hours and 30 minutes before
                        }
                        
                        // Check if there's a custom run-through offset
                        let runThroughTime;
                        if (item['Custom RunThrough Offset'] !== undefined) {
                            runThroughTime = calcTimeOffset(perfTime, item['Custom RunThrough Offset']);
                        } else {
                            // Calculate optimal run-through time if no custom value
                            const baseRunThroughMinutes = 60; // Start with 1 hour before as baseline
                            runThroughTime = calcOptimalRunThroughTime(perfTime, items, baseRunThroughMinutes);
                        }
                        // Props indicator
                        const hasProps = item.Props.toLowerCase().includes('yes');
                        const propsClass = hasProps ? 'props-yes' : 'props-no';
                        const propsText = hasProps ? 'Yes' : 'No';
                        
                        // Check if this is an award entry
                        const isAwardEntry = activityType.includes('award');
                        
                        html += `
                            <tr class="${rowClass}">
                                <td class="time-column performance-time" data-label="Time">${perfTime}</td>
                                <td data-label="Routine #">${item['Routine Number']}</td>
                                <td data-label="Routine">${item['Routine Name']}</td>
                                <td data-label="Category">${item.Category}</td>
                                <td data-label="Dancers">${item['Dancer Names']}</td>
                                <td data-label="Props"><span class="props-indicator ${propsClass}">${propsText}</span></td>
                                ${isAwardEntry ?
                                    `<td class="time-column" data-label="Arrival">-</td>
                                    <td class="time-column" data-label="Run-Through">-</td>`
                                    :
                                    `<td class="time-column arrival-time" data-label="Arrival">${arrivalTime}</td>
                                    <td class="time-column run-through-time" data-label="Run-Through">${runThroughTime}</td>`
                                }
                            </tr>
                        `;
                    });
                    
                    html += `
                                </tbody>
                            </table>
                        </div>
                    `;
                });
            }
            
            scheduleView.innerHTML = html;
        }
        
        // Helper function to calculate time offset (in minutes) and round to nearest quarter hour
        function calcTimeOffset(timeStr, offsetMinutes) {
            const [hourStr, minuteStr] = timeStr.split(':');
            const hour = parseInt(hourStr);
            const minute = parseInt(minuteStr);
            
            // Extract AM/PM
            const ampm = minuteStr.includes('AM') ? 'AM' : 'PM';
            
            // Calculate base hour in 24-hour format
            let hour24 = hour;
            if (ampm === 'PM' && hour !== 12) hour24 += 12;
            if (ampm === 'AM' && hour === 12) hour24 = 0;
            
            // Calculate total minutes since midnight
            let totalMinutes = hour24 * 60 + minute + offsetMinutes;
            
            // Make sure we stay within a day (0-1439 minutes)
            while (totalMinutes < 0) totalMinutes += 24 * 60;
            totalMinutes = totalMinutes % (24 * 60);
            
            // Round to nearest 15 minutes (quarter hour)
            totalMinutes = Math.round(totalMinutes / 15) * 15;
            
            // Convert back to 12-hour format
            const newHour24 = Math.floor(totalMinutes / 60);
            let newHour = newHour24 % 12;
            if (newHour === 0) newHour = 12;
            
            const newMinute = totalMinutes % 60;
            const newAmPm = newHour24 < 12 ? 'AM' : 'PM';
            
            return `${newHour}:${newMinute.toString().padStart(2, '0')} ${newAmPm}`;
        }
// Store calculated run-through times to avoid conflicts
const scheduledRunThroughs = [];

// Time editing functionality
let isEditMode = false;
let originalScheduleData = null;
let modifiedEntries = [];

// Password protection
// ==========================================
// CONFIGURATION: CHANGE THE PASSWORD HERE
// ==========================================
const EDIT_PASSWORD = "DanceSchedule2025"; // Set your girlfriend's password here
// This is the only line you need to change to update the password

// Function to check password (simplified for demonstration)
function validatePassword() {
    const passwordInput = document.getElementById('edit-password');
    const errorMessage = document.getElementById('password-error');
    const password = passwordInput.value;
    
    if (password === EDIT_PASSWORD) {
        // Password correct, close modal and enter edit mode
        document.getElementById('password-modal').style.display = 'none';
        enterEditMode();
    } else {
        // Password incorrect, show error
        errorMessage.textContent = "Incorrect password. Please try again.";
        errorMessage.classList.add('visible');
        passwordInput.focus();
    }
}

// Function to show password modal
function showPasswordModal() {
    const modal = document.getElementById('password-modal');
    const passwordInput = document.getElementById('edit-password');
    const errorMessage = document.getElementById('password-error');
    
    // Reset password field and error
    passwordInput.value = '';
    errorMessage.classList.remove('visible');
    
    // Show modal
    modal.style.display = 'block';
    passwordInput.focus();
}


// Function to enter edit mode
function enterEditMode() {
    isEditMode = true;
    const editModeBtn = document.getElementById('toggle-edit-mode');
    const editControls = document.getElementById('edit-controls');
    
    // Update UI
    editModeBtn.innerHTML = '<i class="fas fa-edit"></i> Exit Edit Mode';
    document.body.classList.add('edit-mode');
    editControls.classList.add('active');
    
    // Backup original schedule data
    originalScheduleData = JSON.parse(JSON.stringify(scheduleData));
    
    // Make performance time cells editable
    makeTimeFieldsEditable();
    
    // Reset modification tracking
    modifiedEntries = [];
}

// Function to toggle edit mode
function toggleEditMode() {
    if (isEditMode) {
        // Already in edit mode, exit
        exitEditMode(false); // Don't save changes
    } else {
        // Not in edit mode, show password modal
        showPasswordModal();
    }
}

// Function to exit edit mode
function exitEditMode(saveChanges) {
    // Update UI
    const editModeBtn = document.getElementById('toggle-edit-mode');
    editModeBtn.innerHTML = '<i class="fas fa-edit"></i> Edit Schedule';
    document.body.classList.remove('edit-mode');
    document.getElementById('edit-controls').classList.remove('active');
    
    // If not saving, restore original data
    if (!saveChanges && originalScheduleData) {
        scheduleData = originalScheduleData;
        updateScheduleView(); // Refresh the view
    }
    
    // Reset state
    isEditMode = false;
    originalScheduleData = null;
    modifiedEntries = [];
}

// Function to make time fields editable
function makeTimeFieldsEditable() {
    // Wait for DOM to be updated
    setTimeout(() => {
        // Select all arrival and run-through time cells
        const arrivalCells = document.querySelectorAll('.schedule-table td.arrival-time');
        const runThroughCells = document.querySelectorAll('.schedule-table td.run-through-time');
        
        // Make arrival times editable
        arrivalCells.forEach(cell => {
            makeTimeEditable(cell, 'arrival');
        });
        
        // Make run-through times editable
        runThroughCells.forEach(cell => {
            makeTimeEditable(cell, 'run-through');
        });
    }, 200);
}

// Function to make a specific time cell editable
function makeTimeEditable(cell, timeType) {
    // Add editable class
    cell.classList.add('editable-cell');
    
    // Add click handler
    cell.addEventListener('click', function() {
        if (!isEditMode) return;
        
        const currentTime = this.textContent.trim();
        
        // Create input field
        const input = document.createElement('input');
        input.type = 'text';
        input.value = currentTime;
        input.className = 'time-input';
        input.pattern = '(1[0-2]|0?[1-9]):[0-5][0-9] (AM|PM)';
        input.title = 'Enter time in format: 10:30 AM';
        
        // Replace cell content with input
        this.innerHTML = '';
        this.appendChild(input);
        input.focus();
        
        // Get row data for tracking changes
        const row = this.closest('tr');
        const routineNumber = row.querySelector('td[data-label="Routine #"]').textContent.trim();
        const perfTimeCell = row.querySelector('td.performance-time');
        const perfTime = perfTimeCell ? perfTimeCell.textContent.trim() : '';
        
        // Handle input events
        input.addEventListener('blur', function() {
            finishTimeEditing(cell, input, routineNumber, timeType, perfTime);
        });
        
        input.addEventListener('keydown', function(e) {
            if (e.key === 'Enter') {
                finishTimeEditing(cell, input, routineNumber, timeType, perfTime);
            } else if (e.key === 'Escape') {
                cell.innerHTML = currentTime;
            }
        });
    });
}

// Function to finish editing a time cell
function finishTimeEditing(cell, input, routineNumber, timeType, perfTime) {
    const newTime = input.value.trim();
    
    // Validate time format
    const timePattern = /(1[0-2]|0?[1-9]):[0-5][0-9] (AM|PM)/;
    if (!timePattern.test(newTime)) {
        alert('Please enter time in format: 10:30 AM');
        input.focus();
        return;
    }
    
    // Update cell display
    cell.innerHTML = newTime;
    
    // Find the routine in the schedule data
    const entry = scheduleData.find(item => item['Routine Number'] == routineNumber);
    if (entry) {
        // Store the time offset for manual adjustments
        if (timeType === 'arrival') {
            // Calculate and store the manual offset from performance time
            const perfTimeMinutes = convertTimeToMinutes(perfTime);
            const arrivalTimeMinutes = convertTimeToMinutes(newTime);
            const offsetMinutes = arrivalTimeMinutes - perfTimeMinutes;
            
            // Store custom arrival offset
            entry['Custom Arrival Offset'] = offsetMinutes;
        } else if (timeType === 'run-through') {
            // Calculate and store the manual offset from performance time
            const perfTimeMinutes = convertTimeToMinutes(perfTime);
            const runThroughTimeMinutes = convertTimeToMinutes(newTime);
            const offsetMinutes = runThroughTimeMinutes - perfTimeMinutes;
            
            // Store custom run-through offset
            entry['Custom RunThrough Offset'] = offsetMinutes;
        }
        
        // Add to modified entries list
        if (!modifiedEntries.includes(entry)) {
            modifiedEntries.push(entry);
        }
        
        // Update the status message
        const statusMsg = document.getElementById('status-message');
        statusMsg.textContent = `Modified ${modifiedEntries.length} schedule entries. Click Save to apply changes.`;
    }
}

// Function to save all changes
function saveChanges() {
    if (modifiedEntries.length === 0) {
        alert('No changes to save');
        return;
    }
    
    // In a real application, this would send data to a server
    // For this demo, we'll just show a success message
    alert(`Successfully saved ${modifiedEntries.length} schedule changes!`);
    
    // Exit edit mode
    exitEditMode(true); // Save changes
    
    // Update status message
    const statusMsg = document.getElementById('status-message');
    statusMsg.textContent = `Schedule updated successfully! (${modifiedEntries.length} changes saved)`;
    
    // Force recalculation of all times
    updateScheduleView();
}

// Add event listeners for edit functionality
document.addEventListener('DOMContentLoaded', function() {
    const existingHandlers = window.onload;
    window.onload = function() {
        if(existingHandlers) existingHandlers();
        
        // Edit mode button
        document.getElementById('toggle-edit-mode').addEventListener('click', toggleEditMode);
        document.getElementById('save-changes').addEventListener('click', saveChanges);
        document.getElementById('cancel-edit').addEventListener('click', function() {
            exitEditMode(false); // Don't save changes
        });
        
        // Password modal
        document.getElementById('submit-password').addEventListener('click', validatePassword);
        document.getElementById('cancel-password').addEventListener('click', function() {
            document.getElementById('password-modal').style.display = 'none';
        });
        
        // Allow Enter key in password field
        document.getElementById('edit-password').addEventListener('keydown', function(e) {
            if (e.key === 'Enter') {
                validatePassword();
            } else if (e.key === 'Escape') {
                document.getElementById('password-modal').style.display = 'none';
            }
        });
        
        // Close password modal when clicking outside
        window.addEventListener('click', function(e) {
            const modal = document.getElementById('password-modal');
            if (e.target === modal) {
                modal.style.display = 'none';
            }
        });
    };
});

// Function to calculate optimal run-through time based on performance schedule
        function calcOptimalRunThroughTime(perfTime, allItems, baseMinutesBefore) {
            // Convert performance time to minutes for calculations
            const perfTimeMinutes = convertTimeToMinutes(perfTime);
            
            // Start with the ideal run-through time (baseMinutesBefore before performance)
            let runThroughMinutes = perfTimeMinutes - baseMinutesBefore;
            
            // Sort all items by performance time
            const sortedItems = [...allItems].sort((a, b) => {
                return convertTimeToMinutes(a['Est. Performance Time']) - convertTimeToMinutes(b['Est. Performance Time']);
            });
            
            // Find the index of the current performance
            const currentIndex = sortedItems.findIndex(item => item['Est. Performance Time'] === perfTime);
            
            // Function to check if a given run-through time would conflict with any performances or other run-throughs
            const hasConflict = (runThroughMin) => {
                // Each performance takes about 5 minutes, each run-through needs 15 minutes
                const runThroughStart = runThroughMin;
                const runThroughEnd = runThroughMin + 15; // 15 min for run-through
                
                // Check conflicts with performances
                const performanceConflict = sortedItems.some((item, index) => {
                    // Skip checking against self
                    if (index === currentIndex) return false;
                    
                    const itemPerfTime = convertTimeToMinutes(item['Est. Performance Time']);
                    const itemPerfEnd = itemPerfTime + 5; // 5 min for performance
                    
                    // Check if run-through overlaps with this performance
                    return (runThroughStart < itemPerfEnd && runThroughEnd > itemPerfTime);
                });
                
                if (performanceConflict) return true;
                
                // Check conflicts with other scheduled run-throughs
                return scheduledRunThroughs.some(existingRunThrough => {
                    const existingStart = existingRunThrough;
                    const existingEnd = existingRunThrough + 15; // 15 min duration
                    
                    // Check for overlap
                    return (runThroughStart < existingEnd && runThroughEnd > existingStart);
                });
            };
            
            // If the initial proposed time conflicts, search for a better time
            if (hasConflict(runThroughMinutes)) {
                // Try earlier times first in 5-minute increments, up to 60 minutes earlier
                for (let offset = 5; offset <= 60; offset += 5) {
                    const earlierTime = runThroughMinutes - offset;
                    if (earlierTime >= perfTimeMinutes - 120 && !hasConflict(earlierTime)) { // Don't go more than 2 hours before
                        runThroughMinutes = earlierTime;
                        break;
                    }
                    
                    // Also try later times (but not too close to performance)
                    const laterTime = runThroughMinutes + offset;
                    if (laterTime <= perfTimeMinutes - 20 && !hasConflict(laterTime)) { // At least 20 min before performance
                        runThroughMinutes = laterTime;
                        break;
                    }
                }
                
                // If still conflicting, search through a wider range
                if (hasConflict(runThroughMinutes)) {
                    // Try even earlier times if necessary
                    for (let minutes = 65; minutes <= 120; minutes += 5) {
                        const time = perfTimeMinutes - minutes;
                        if (!hasConflict(time)) {
                            runThroughMinutes = time;
                            break;
                        }
                    }
                }
            }
            
            // Add this run-through to the scheduled list to avoid future conflicts
            scheduledRunThroughs.push(runThroughMinutes);
            
            // Convert back to time string
            let newHour24 = Math.floor(runThroughMinutes / 60);
            let newMinutes = runThroughMinutes % 60;
            let newHour = newHour24 % 12;
            if (newHour === 0) newHour = 12;
            const newAmPm = newHour24 < 12 ? 'AM' : 'PM';
            
            return `${newHour}:${newMinutes.toString().padStart(2, '0')} ${newAmPm}`;
        }
</script>
<script src="dancers.js"></script>
</body>
</html>